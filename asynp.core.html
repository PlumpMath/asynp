<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>asynp.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Asynp 0.0.4-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li class="current"><a href="asynp.core.html"><span>asynp.core</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="asynp.core.html#var-*callback-timeout-ms*"><span>*callback-timeout-ms*</span></a></li><li><a href="asynp.core.html#var-*working-buffer-size*"><span>*working-buffer-size*</span></a></li><li><a href="asynp.core.html#var-array-from-buffer"><span>array-from-buffer</span></a></li><li><a href="asynp.core.html#var-asynp.core.proxy%24java.lang.Object%24NuProcessHandler%2448aaa3b5"><span>asynp.core.proxy$java.lang.Object$NuProcessHandler$48aaa3b5</span></a></li><li><a href="asynp.core.html#var-close-stdin-for-process"><span>close-stdin-for-process</span></a></li><li><a href="asynp.core.html#var-decode-chars"><span>decode-chars</span></a></li><li><a href="asynp.core.html#var-log-strings"><span>log-strings</span></a></li><li><a href="asynp.core.html#var-run-process"><span>run-process</span></a></li><li><a href="asynp.core.html#var-shutdown-process"><span>shutdown-process</span></a></li><li><a href="asynp.core.html#var-split-by-char"><span>split-by-char</span></a></li><li><a href="asynp.core.html#var-wait-for-process"><span>wait-for-process</span></a></li><li><a href="asynp.core.html#var-write-str-to-process"><span>write-str-to-process</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>asynp.core documentation</h2><pre class="doc"></pre><div class="public" id="var-*callback-timeout-ms*"><h3>*callback-timeout-ms*</h3><div class="usage"></div><pre class="doc">Maximum number of milliseconds to block in NuProcess callback thread before timing out and failing loudly. Serves as a failsafe for cases where channel readers are hung or not present. Set to nil to disable timeout.
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L22">Source</a></div></div><div class="public" id="var-*working-buffer-size*"><h3>*working-buffer-size*</h3><div class="usage"></div><pre class="doc">Initial size of the destination buffer for reads. Will be reallocated with a larger size as-needed.
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L18">Source</a></div></div><div class="public" id="var-array-from-buffer"><h3>array-from-buffer</h3><div class="usage"><code>(array-from-buffer buffer)</code></div><pre class="doc">Given a ByteBuffer, return an array of bytes
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L26">Source</a></div></div><div class="public" id="var-asynp.core.proxy%24java.lang.Object%24NuProcessHandler%2448aaa3b5"><h3>asynp.core.proxy$java.lang.Object$NuProcessHandler$48aaa3b5</h3><div class="usage"></div><pre class="doc"></pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/#L">Source</a></div></div><div class="public" id="var-close-stdin-for-process"><h3>close-stdin-for-process</h3><div class="usage"><code>(close-stdin-for-process proc-dict)</code></div><pre class="doc">Queue a close event for a process's stdin.

This event will only be executed after the process is ready to read from its stdin</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L249">Source</a></div></div><div class="public" id="var-decode-chars"><h3>decode-chars</h3><div class="usage"><code>(decode-chars in-chan)</code><code>(decode-chars in-chan charset)</code></div><pre class="doc">given a stream of byte arrays, emit a stream of CharBuffers
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L122">Source</a></div></div><div class="public" id="var-log-strings"><h3>log-strings</h3><div class="usage"><code>(log-strings in-chan)</code><code>(log-strings in-chan split-char)</code></div><pre class="doc">Debugging aid: Given a channel delivering character buffers, log the contained strings using Timbre

When given a character to split by, log only when a complete character-delimited buffer is received, or at end-of-stream.</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L227">Source</a></div></div><div class="public" id="var-run-process"><h3>run-process</h3><div class="usage"><code>(run-process argv &amp; {:keys [shutdown-chan]})</code></div><pre class="doc">Run a process with the given argv, and return a dictionary with access to the process object itself and channels for controlling it.

Accepts the following optional keyword arguments:
- `shutdown-chan`: use a preexisting channel to force shutdown

Returns a dictionary with the following keys:
- `:process` - a NuProcess object
- `:in` - an unbuffered channel used for input. Contents will be streamed to the process's stdin.
- `:out` - an unbuffered channel used for output. Contains contents read from the process's stdout.
- `:err` - an unbuffered channel used for output. Contains contents read from the process's stderr.
- `:exit` - a buffered channel used for output. Empty until process has exited. Contains exit status, or INT_MIN if process was not successfully invoked.
- `:shutdown` - an unbuffered channel used for input. Closing this channel will force the process to exit.

All objects on the :in, :out or :err channels will be byte arrays.</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L34">Source</a></div></div><div class="public" id="var-shutdown-process"><h3>shutdown-process</h3><div class="usage"><code>(shutdown-process proc-dict)</code></div><pre class="doc">Force process to shut down immediately by closing its shutdown channel.

Note that this can have side effects if an external (shared) shutdown channel was supplied rather than allowing a new one to be created by default.</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L266">Source</a></div></div><div class="public" id="var-split-by-char"><h3>split-by-char</h3><div class="usage"><code>(split-by-char in-chan delim-char)</code></div><pre class="doc">given a channel delivering character arrays, merge and split by a delimiter
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L191">Source</a></div></div><div class="public" id="var-wait-for-process"><h3>wait-for-process</h3><div class="usage"><code>(wait-for-process proc-dict)</code><code>(wait-for-process proc-dict timeout-ms)</code></div><pre class="doc">Block until a process exits, or an optional timeout occurs; return exit status, or nil for timeout
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L256">Source</a></div></div><div class="public" id="var-write-str-to-process"><h3>write-str-to-process</h3><div class="usage"><code>(write-str-to-process proc-dict s)</code></div><pre class="doc">Given a process dictionary, queue content to be written to its stdin
</pre><div class="src-link"><a href="http://github.com/threatgrid/asynp/blob/master/src/asynp/core.clj#L244">Source</a></div></div></div></body></html>